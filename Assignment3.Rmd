---
title: "Assignment 3"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Load Packages, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

library(tidyverse)
library(stargazer)
#load csv
 
hw3 <- read_csv("HW3Data.csv")


```

###1. Linear Probability Model 

```{r Question 1, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

# Create a linear probability model that predicts a respondent's probability of voting 'yes' on the ballot based on their age, income, NEP score, the risk reduction offered by the program (risk), and the cost of the program to that respondent (bid). 

lm_vote <- lm(formula = vote ~ risk + bid + NEP + income + age, data = hw3)

summary(lm_vote)



# Coefficients:
#       (Vote)               risk                bid                NEP     incomeone_percent         incomepoor  
#         0.1196977          0.0007445         -0.0010699          0.0158639          0.0088282          0.0027386  

#        incomerich    incomevery_rich         agetofifty         agetoforty         agetosixty        agetothirty  
#         0.0074891          0.0467922          0.0099816         -0.0201190         -0.0162261          0.0204401 



# Analyzing coefficients:


# For every 1% increase in risk reduction, there is an increase in probablility of voting YES by 0.0007445.
# For every $1 increase in cost per household, there is a decrease in probability of voting YES by 0.0010699.
# For every additional point increase for NEP score, there is an increase in probability of voting YES by 0.0158639.
# Individuals in the top one percent income category are 0.0088282 more likely to vote YES than individuals in the middle income class.
# Individuals in the poor income category are 0.0027386 more likely to vote YES than inidividuals in the middle income category. 
# Individuals in the rich income category are 0.0074891 more likely to vote YES than inidividuals in the middle income category.
# Individuals in the very rich income category are 0.0467922 more likely to vote YES than inidividuals in the middle income category.

# Age to fifty individuals are 0.0099816 more likely to vote YES than age over 60.
# Age to 40 individuals are 0.0201190 more likely to vote YES than age over 60.
# Age to 60 are 0.0162261 are less likely to vote YES than age over 60.
# Age to 30 are 0.0204401 are less likely to vote YES than age over 60.


#assign the variables

vote_int <- lm_vote$coefficients[1]
risk <- lm_vote$coefficients[2]
bid <- lm_vote$coefficients[3]
NEP <- lm_vote$coefficients[4]
inc_1 <- lm_vote$coefficients[5]
inc_poor <- lm_vote$coefficients[6]
inc_rich <- lm_vote$coefficients[7]
inc_vrich <- lm_vote$coefficients[8]
age_50 <- lm_vote$coefficients[9]
age_40 <- lm_vote$coefficients[10]
age_60 <- lm_vote$coefficients[11]
age_30 <- lm_vote$coefficients[12]


# Put linear model into stargazer table 

# stargazer(lm_vote)



```

$Probability(Voting~Yes) = `r round(vote_int, digits = 4)` + `r round(age_30, digits=4)`(Age~to~30) - `r round(age_40, digits=4)`(Age~to~40) + `r round(age_50, digits=4)`(Age~to~50) - `r round(age_60, digits=4)`(Age~to~60) + `r round(inc_1, digits=4)`(Income~One~Percent) + `r round(inc_poor, digits=4)`(Income~Poor) + `r round(inc_rich, digits=4)`(Income~Rich) + `r round(inc_vrich,digits=4)`(Income~Very~Rich) + `r round(NEP, digits=4)`(NEP) - `r round(bid, digits=4)`(Bid) + `r round(risk, digits=4)`(Risk~Reduction)$


```{r Question 2, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

## Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths avoided)

#In order to reduce the risk of one whale strike, reduce the risk to 4%. 

#The average of voting YES is 0.5

#Compare the willingness to pay at business as usual (VSR of 0) to the willingness to pay when increasing the VSR to 4%. 

#average of voting yes or no (0 or 1) is 0.5
avg_vote <- 0.5



#average of NEP
NEP_avg <- mean(hw3$NEP)  


#Find the Bid (cost to households) when reduction is 0% = 269 

bid_zero <- (vote_int + (risk*0) + (NEP*NEP_avg) + inc_1 + inc_poor + inc_vrich + inc_rich + age_50 + age_30 + age_40 + age_60 - avg_vote)/(-bid)

#Find the Bid (cost to households) when reduction is 4% = 272

bid_four <- (vote_int + (risk*4) + (NEP*NEP_avg) + inc_1 + inc_poor + inc_rich + inc_vrich + age_50 + age_30 + age_40 + age_60 - avg_vote)/(-bid)

#The value of a single whale is the difference between the willingness to pay (i.e.Bid) for a vessel speed reduction program at 4% and at 0%. = 2.78

wtp_value <- bid_four - bid_zero 


```




```{r Question 3, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

# Pick three arbitrary respondents. For each of those respondents, estimate their WTP for a VSR program offering 60% risk reduction


# Filter for risk = 60%

risk_60 <- hw3 %>% 
  filter(risk == "60")

# Respondent 8:
# Risk = 60
# Bid = 80
# Vote = 1
# NEP = 29
# Income = Very_Rich
# Age = ToThirty
# VSR = 60%

bid_8 <-(vote_int + (NEP*29) + inc_vrich + age_30 - avg_vote)/(-bid) 
# bid_8 = $137


# Respondent 63:
# Risk = 60
# Bid = 20
# Vote = 1
# NEP = 37
# Income = Rich
# Age = OverSixty

bid_63 <-(vote_int + (NEP*37) + inc_rich - avg_vote)/(-bid) 
#bid_63 = $200


# Respondent 7:
# Risk = 60
# Bid = 40
# Vote = 0
# NEP = 22
# Income = One Percent
# Age = ToForty

bid_7 <-(vote_int + (NEP*22) + inc_1 + age_40 - avg_vote)/(bid) 
#bid_7 = $39.80


```

```{r Question 4, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

#find mode of the categorical values: income : "very_rich"
income_mode <- hw3$income

income_mode[hw3 %>%
                match(income_mode) %>% 
                tabulate() %>%
                which.max()]

##find mode of the categorical values: age ; "tothirty"

age_mode <- hw3$age

age_mode[hw3 %>%
                match(age_mode) %>% 
                tabulate() %>%
                which.max()]

#Again assume the probability of voting yes the average of voting yes ($p = .5). Use the most common income bracket (very rich), the most common age bracket (to 30), and average NEP (38.366) to calculate willingness to pay using:

bid_sb <- (vote_int + (NEP*NEP_avg) + age_30 + inc_vrich + (risk*60) - avg_vote)/(-bid)

#the average WTP for all of Santa Barbara residents for 60% risk reduction program is $318


```

```{r Question 5, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

# If there are 150,000 households in SB County, estimate the total benefit of a VSR program to these households

bid_sbtotal <- ((vote_int + (NEP*NEP_avg) + age_30 + inc_vrich + risk - avg_vote)/(-bid))* 150000

# The total benefit of a VSR program for all 150,000 [average] households is $41,542,642


```


```{r Question 6, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

# Based on the SB Total benefits, do the benefits of the VSR program outweigh the costs?

# Costs of VSR program = $7 million
# Total benefits to SB households = $41,542,642

# YES, benefits outweigh the costs!

```


```{r Question 7, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}



```



```{r Question 8, echo = FALSE, include = FALSE, message = FALSE, warning = FALSE}

```

